<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.116.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple-touch-icon.png><meta itemprop=name content="使用Vue开发Chrome插件"><meta itemprop=description content="使用 Vue2 开发一个 Chrome 插件"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blog.jiandan.cf/imgs/babiwawa.png"><meta itemprop=keywords content="chrome,plugin,vue,develop"><meta property="og:type" content="article"><meta property="og:title" content="使用Vue开发Chrome插件"><meta property="og:description" content="使用 Vue2 开发一个 Chrome 插件"><meta property="og:image" content="/imgs/babiwawa.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blog.jiandan.cf/post/program/vue-chrome-extension/"><meta property="og:site_name" content="爸比娃娃的博客"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="爸比娃娃"><meta property="article:published_time" content="2021-09-18 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2021-09-18 00:00:00 +0000 UTC"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.ad1ea33a63f63e6a94f5de191c205129577cfd392e2e10dec0f173ca5bdf0b7b.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"vue-chrome-extension","permalink":"https://blog.jiandan.cf/post/program/vue-chrome-extension/","title":"使用Vue开发Chrome插件","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>使用Vue开发Chrome插件 - 爸比娃娃的博客</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>爸比娃娃的博客</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>爸比娃娃的博客</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>125</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#环境搭建>环境搭建</a><ul><li><a href=#项目结构>项目结构</a></li><li><a href=#安装组件库>安装组件库</a><ul><li><a href=#安装-elementui>安装 elementUI</a></li><li><a href=#安装-tailwindcss>安装 tailwindcss</a></li></ul></li></ul></li><li><a href=#项目搭建>项目搭建</a><ul><li><a href=#页面搭建>页面搭建</a></li><li><a href=#悬浮窗>悬浮窗</a></li><li><a href=#功能实现>功能实现</a><ul><li><a href=#输出相关信息>输出相关信息</a></li><li><a href=#实现评论>实现评论</a></li></ul></li></ul></li><li><a href=#相关模板>相关模板</a></li><li><a href=#整体体验>整体体验</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=爸比娃娃 src=/imgs/img-lazy-loading.gif data-src=/imgs/babiwawa.png><p class=site-author-name itemprop=name>爸比娃娃</p><div class=site-description itemprop=description>有钱说什么都是硬道理，没钱说什么都是吹牛逼。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>125</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>4</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>117</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/babiwawa title="Github → https://github.com/babiwawa" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span>
<span class=links-of-social-item><a href=mailto:1223112302@qq.com title="E-Mail → mailto:1223112302@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail</a></span>
<span class=links-of-social-item><a href=https://www.zhihu.com/people/hbalnw title="知乎 → https://www.zhihu.com/people/hbalnw" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://jiandan.cf title=https://jiandan.cf target=_blank>简单导航</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=0001-01-01T00:00:00+00:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=287557></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=640></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2023-01-04T00:00:00+00:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=直达底部><i class="fas fa-arrow-down"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/babiwawa rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script>
<script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blog.jiandan.cf/post/program/vue-chrome-extension/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/babiwawa.png"><meta itemprop=name content="爸比娃娃"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="爸比娃娃"><meta itemprop=description content="有钱说什么都是硬道理，没钱说什么都是吹牛逼。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="使用Vue开发Chrome插件"><meta itemprop=description content="使用 Vue2 开发一个 Chrome 插件"></span><header class=post-header><h1 class=post-title itemprop="name headline">使用Vue开发Chrome插件</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text title=发表于>发表于：</span>
<time title="创建时间：2021-09-18 00:00:00 +0000 UTC" itemprop="dateCreated datePublished" datetime="2021-09-18 00:00:00 +0000 UTC">2021-09-18</time></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span>
<span>4385</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>9分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv data-path=/post/program/vue-chrome-extension/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/mini.jpg alt=mini></p><h2 id=前言>前言
<a class=header-anchor href=#%e5%89%8d%e8%a8%80></a></h2><p>我当时学习开发 Chrome 插件的时候，还不会 Vue，更别说 Webpack 了，所以使用的都是原生的 html 开发，效率就不提了，而这次就准备使用 vue-cli 来进行编写一个某 B 站获取视频信息,评论的功能（原本是打算做自动回复的），顺便巩固下 chrome 开发（快一年没碰脚本类相关技术了），顺便写套模板供自己后续编写 Chrome 插件做铺垫。</p><p>相关代码开源
<a href=https://github.com/kuizuo/vue-chrome-extension title="github 地址" rel="noopener external nofollow noreferrer" target=_blank class=exturl>github 地址
<i class="fa fa-external-link-alt"></i></a></p><h2 id=环境搭建>环境搭建
<a class=header-anchor href=#%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba></a></h2><p><a href=https://vue-web-extension.netlify.app/ title="Vue Web-Extension - A Web-Extension preset for VueJS (vue-web-extension.netlify.app)" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Vue Web-Extension - A Web-Extension preset for VueJS (vue-web-extension.netlify.app)
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-sh data-lang=sh><span style=display:flex><span>npm install -g @vue/cli
</span></span><span style=display:flex><span>npm install -g @vue/cli-init
</span></span><span style=display:flex><span>vue create --preset kocal/vue-web-extension my-extension
</span></span><span style=display:flex><span>cd my-extension
</span></span><span style=display:flex><span>npm run server
</span></span></code></pre></div><p>会提供几个选项，如 Eslint，background.js，tab 页，axios，如下图</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210916142751129.png alt=image-20210916142751129></p><p>选择完后，将会自动下载依赖，通过 npm run server 将会在根目录生成 dist 文件夹，将该文件拖至 Chrome 插件管理便可安装，由于使用了 webpack，所以更改代码将会热更新，不用反复的编译导入。</p><h3 id=项目结构>项目结构
<a class=header-anchor href=#%e9%a1%b9%e7%9b%ae%e7%bb%93%e6%9e%84></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>├─src
</span></span><span style=display:flex><span>|  ├─App.vue
</span></span><span style=display:flex><span>|  ├─background.js
</span></span><span style=display:flex><span>|  ├─main.js
</span></span><span style=display:flex><span>|  ├─manifest.json
</span></span><span style=display:flex><span>|  ├─views
</span></span><span style=display:flex><span>|  |   ├─About.vue
</span></span><span style=display:flex><span>|  |   └Home.vue
</span></span><span style=display:flex><span>|  ├─store
</span></span><span style=display:flex><span>|  |   └index.js
</span></span><span style=display:flex><span>|  ├─standalone
</span></span><span style=display:flex><span>|  |     ├─App.vue
</span></span><span style=display:flex><span>|  |     └main.js
</span></span><span style=display:flex><span>|  ├─router
</span></span><span style=display:flex><span>|  |   └index.js
</span></span><span style=display:flex><span>|  ├─popup
</span></span><span style=display:flex><span>|  |   ├─App.vue
</span></span><span style=display:flex><span>|  |   └main.js
</span></span><span style=display:flex><span>|  ├─override
</span></span><span style=display:flex><span>|  |    ├─App.vue
</span></span><span style=display:flex><span>|  |    └main.js
</span></span><span style=display:flex><span>|  ├─options
</span></span><span style=display:flex><span>|  |    ├─App.vue
</span></span><span style=display:flex><span>|  |    └main.js
</span></span><span style=display:flex><span>|  ├─devtools
</span></span><span style=display:flex><span>|  |    ├─App.vue
</span></span><span style=display:flex><span>|  |    └main.js
</span></span><span style=display:flex><span>|  ├─content-scripts
</span></span><span style=display:flex><span>|  |        └content-script.js
</span></span><span style=display:flex><span>|  ├─components
</span></span><span style=display:flex><span>|  |     └HelloWorld.vue
</span></span><span style=display:flex><span>|  ├─assets
</span></span><span style=display:flex><span>|  |   └logo.png
</span></span><span style=display:flex><span>├─public
</span></span><span style=display:flex><span>├─.browserslistrc
</span></span><span style=display:flex><span>├─.eslintrc.js
</span></span><span style=display:flex><span>├─.gitignore
</span></span><span style=display:flex><span>├─babel.config.js
</span></span><span style=display:flex><span>├─package.json
</span></span><span style=display:flex><span>├─vue.config.js
</span></span><span style=display:flex><span>├─yarn.lock
</span></span></code></pre></div><p>根据所选的页面，并在 src 与 vue.config.js 中配置页面信息编译后 dist 目录结构如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>├─devtools.html
</span></span><span style=display:flex><span>├─favicon.ico
</span></span><span style=display:flex><span>├─index.html
</span></span><span style=display:flex><span>├─manifest.json
</span></span><span style=display:flex><span>├─options.html
</span></span><span style=display:flex><span>├─override.html
</span></span><span style=display:flex><span>├─popup.html
</span></span><span style=display:flex><span>├─_locales
</span></span><span style=display:flex><span>├─js
</span></span><span style=display:flex><span>├─icons
</span></span><span style=display:flex><span>├─css
</span></span></code></pre></div><h3 id=安装组件库>安装组件库
<a class=header-anchor href=#%e5%ae%89%e8%a3%85%e7%bb%84%e4%bb%b6%e5%ba%93></a></h3><h4 id=安装-elementui>安装 elementUI
<a class=header-anchor href=#%e5%ae%89%e8%a3%85-elementui></a></h4><p>整体的开发和 vue2 开发基本上没太大的区别，不过既然是用 vue 来开发的话，那肯定少不了组件库了。</p><p>要导入 Element-ui 也十分简单，<code>Vue.use(ElementUI); </code>Vue2 中怎么导入 element，便怎么导入。演示如下</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210916150154078.png alt=image-20210916150154078></p><p>不过我没有使用 babel-plugin-component 来按需引入，按需引入一个按钮打包后大约 1.6m，而全量引入则是 5.5 左右。至于为什么不用，因为我需要在 content-scripts.js 中引入 element 组件，如果使用 babel-plugin-component 将无法按需导入组件以及样式（应该是只支持 vue 文件按需引入，总之就是折腾了我一个晚上的时间）</p><h4 id=安装-tailwindcss>安装 tailwindcss
<a class=header-anchor href=#%e5%ae%89%e8%a3%85-tailwindcss></a></h4><p>不过官方提供了如何使用 TailwindCSS，这里就演示一下</p><p><a href=https://www.tailwindcss.cn/docs/guides/vue-3-vite title="在 Vue 3 和 Vite 安装 Tailwind CSS - Tailwind CSS 中文文档" rel="noopener external nofollow noreferrer" target=_blank class=exturl>在 Vue 3 和 Vite 安装 Tailwind CSS - Tailwind CSS 中文文档
<i class="fa fa-external-link-alt"></i></a></p><p>推荐安装低版本，最新版有兼容性问题</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>npm install tailwindcss@npm:@tailwindcss/postcss7-compat postcss@^7 autoprefixer@^9
</span></span></code></pre></div><p>创建 postcss.config.js 文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// postcss.config.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;tailwindcss&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;autoprefixer&#39;</span>), <span style=color:#75715e>// if you have installed `autoprefixer`
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  ],
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>创建 tailwind.config.js 文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// tailwind.config.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>purge</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Specify the paths to all of the template files in your project
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;src/**/*.vue&#39;</span>],
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Whitelist selectors by using regular expression
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>whitelistPatterns</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/-(leave|enter|appear)(|-(to|from|active))$/</span>, <span style=color:#75715e>// transitions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#e6db74>/data-v-.*/</span>, <span style=color:#75715e>// scoped css
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>在 src/popup/App.vue 中导入样式，或在新建 style.css 在 mian.js 中<code>import "../style.css";</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>/* purgecss start ignore */</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>tailwind</span> <span style=color:#a6e22e>base</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>tailwind</span> <span style=color:#a6e22e>components</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>/* purgecss end ignore */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>tailwind</span> <span style=color:#a6e22e>utilities</span>;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>style</span>&gt;
</span></span></code></pre></div><p>从官方例子导入一个登陆表单，效果如下</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210916152633247.png alt=image-20210916152633247></p><h2 id=项目搭建>项目搭建
<a class=header-anchor href=#%e9%a1%b9%e7%9b%ae%e6%90%ad%e5%bb%ba></a></h2><h3 id=页面搭建>页面搭建
<a class=header-anchor href=#%e9%a1%b5%e9%9d%a2%e6%90%ad%e5%bb%ba></a></h3><p>页面搭建就没什么好说的了，因为使用的是 element-ui，所以页面很快就搭建完毕了，效果如图</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210918115438700.png alt=image-20210918115438700></p><h3 id=悬浮窗>悬浮窗
<a class=header-anchor href=#%e6%82%ac%e6%b5%ae%e7%aa%97></a></h3><p>悬浮窗其实可有可无，不过之前写 Chrome 插件的时候就写了悬浮窗，所以 vue 版的也顺带写一份。</p><p>要注意的是悬浮窗是内嵌到网页的（且在 document 加载前载入，也就是<code>"run_at": "document_start"</code>），所以需要通过 content-scripts.js 才能操作页面 Dom 元素，首先在配置清单 manifest.json 与 vue.confing.js 中匹配要添加的网站，以及注入的 js 代码，如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span>  <span style=color:#e6db74>&#34;content_scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;matches&#34;</span>: [<span style=color:#e6db74>&#34;https://www.bilibili.com/video/*&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;js&#34;</span>: [<span style=color:#e6db74>&#34;js/jquery.js&#34;</span>, <span style=color:#e6db74>&#34;js/content-script.js&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;css&#34;</span>: [<span style=color:#e6db74>&#34;css/index.css&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;run_at&#34;</span>: <span style=color:#e6db74>&#34;document_start&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;matches&#34;</span>: [<span style=color:#e6db74>&#34;https://www.bilibili.com/video/*&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;js&#34;</span>: [<span style=color:#e6db74>&#34;js/jquery.js&#34;</span>, <span style=color:#e6db74>&#34;js/bilibili.js&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;run_at&#34;</span>: <span style=color:#e6db74>&#34;document_end&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>	<span style=color:#a6e22e>contentScripts</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>entries</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;content-script&#39;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;src/content-scripts/content-script.js&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bilibili</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;src/content-scripts/bilibili.js&#39;</span>],
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>        },
</span></span></code></pre></div><p>由于是用 Vue，但又要在 js 中生成组件，就使用<code>document.createElement</code>来进行创建元素，Vue 组件如下（可拖拽）</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210917142340863.png alt=image-20210917142340863></p><p>:::danger</p><p>如果使用<code>babel-plugin-component</code>按需引入，组件的样式将无法载入，同时自定义组件如果编写了 style 标签，那么也同样无法载入，报错：Cannot read properties of undefined (reading &lsquo;appendChild&rsquo;)</p><p>大致就是 css-loader 无法加载对应的 css 代码，如果执意要写 css 的话，直接在 manifest.json 中注入 css 即可</p><p>:::</p><details open><summary>完整代码</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 注意，这里引入的vue是运行时的模块，因为content是插入到目标页面，对组件的渲染需要运行时的vue， 而不是编译环境的vue （我也不知道我在说啥，反正大概意思就是这样）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Vue</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue/dist/vue.esm.js&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>ElementUI</span>, { <span style=color:#a6e22e>Message</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;element-ui&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Vue</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>ElementUI</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 注意，必须设置了run_at=document_start此段代码才会生效
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>document.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;DOMContentLoaded&#39;</span>, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;vue-chrome扩展已载入&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>insertFloat</span>()
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 在target页面中新建一个带有id的dom元素，将vue对象挂载到这个dom上。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>insertFloat</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>element</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;div&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>attr</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createAttribute</span>(<span style=color:#e6db74>&#39;id&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;appPlugin&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>setAttributeNode</span>(<span style=color:#a6e22e>attr</span>)
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>getElementsByTagName</span>(<span style=color:#e6db74>&#39;body&#39;</span>)[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>appendChild</span>(<span style=color:#a6e22e>element</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>link</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;link&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>linkAttr</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createAttribute</span>(<span style=color:#e6db74>&#39;rel&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>linkAttr</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;stylesheet&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>linkHref</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createAttribute</span>(<span style=color:#e6db74>&#39;href&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>linkHref</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://unpkg.com/element-ui/lib/theme-chalk/index.css&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>link</span>.<span style=color:#a6e22e>setAttributeNode</span>(<span style=color:#a6e22e>linkAttr</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>link</span>.<span style=color:#a6e22e>setAttributeNode</span>(<span style=color:#a6e22e>linkHref</span>)
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>getElementsByTagName</span>(<span style=color:#e6db74>&#39;head&#39;</span>)[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>appendChild</span>(<span style=color:#a6e22e>link</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>left</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>top</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>my</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>onDrag</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>drag</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>inserted</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>el</span>) {
</span></span><span style=display:flex><span>      ;(<span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>onmousedown</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>left</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>offsetLeft</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>top</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>offsetTop</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>clientX</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>my</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>clientY</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>my</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>top</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>40</span>) <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onDrag</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      }),
</span></span><span style=display:flex><span>        (window.<span style=color:#a6e22e>onmousemove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>onDrag</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>clientX</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>mx</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>left</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ny</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>clientY</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>my</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>top</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>clientWidth</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>clientHeight</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>bodyWidth</span> <span style=color:#f92672>=</span> window.document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>clientWidth</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>bodyHeight</span> <span style=color:#f92672>=</span> window.document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>clientHeight</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>nx</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#a6e22e>nx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ny</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#a6e22e>ny</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ny</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>bodyHeight</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>bodyHeight</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>ny</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bodyHeight</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>height</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>nx</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>bodyWidth</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>width</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>nx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bodyWidth</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>width</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>nx</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;px&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ny</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;px&#39;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }),
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>onmouseup</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>onDrag</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>onDrag</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  window.<span style=color:#a6e22e>kz_vm</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vue</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>el</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#appPlugin&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>directives</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>drag</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>drag</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>template</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;div class=&#34;float-page&#34; ref=&#34;float&#34; v-drag&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &lt;el-card class=&#34;box-card&#34; :body-style=&#34;{ padding: &#39;15px&#39; }&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          &lt;div slot=&#34;header&#34; class=&#34;clearfix&#34; style=&#34;cursor: move&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;span&gt;悬浮窗&lt;/span&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;el-button style=&#34;float: right; padding: 3px 0&#34; type=&#34;text&#34; @click=&#34;toggle&#34;&gt;{{ show ? &#39;收起&#39; : &#39;展开&#39;}}&lt;/el-button&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          &lt;transition name=&#34;ul&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;div v-if=&#34;show&#34; class=&#34;ul-box&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              &lt;span&gt; {{user}} &lt;/span&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          &lt;/transition&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &lt;/el-card&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      `</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>show</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>list</span><span style=color:#f92672>:</span> [],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>user</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>follow</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>view</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mounted</span>() {},
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>methods</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>toggle</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>show</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>show</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></details><p>因为只能在 js 中编写 vue 组件，所以得用 template 模板，同时使用了 directives，给组件添加了拖拽的功能（尤其是<code>window.onmousemove</code>，如果是元素绑定他自身的鼠标移动事件，那么拖拽鼠标将会十分卡顿），还使用了 transition 来进行缓慢动画效果其中注入的 css 代码如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-css data-lang=css><span style=display:flex><span>.<span style=color:#a6e22e>float-page</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>400</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>border-radius</span>: <span style=color:#ae81ff>8</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>position</span>: <span style=color:#66d9ef>fixed</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>left</span>: <span style=color:#ae81ff>50</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>top</span>: <span style=color:#ae81ff>25</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>z-index</span>: <span style=color:#ae81ff>1000001</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>el-card__header</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>10</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>15</span><span style=color:#66d9ef>px</span> <span style=color:#75715e>!important</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>ul-box</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>200</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>overflow</span>: <span style=color:#66d9ef>hidden</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>ul-enter-active</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>ul-leave-active</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>transition</span>: <span style=color:#66d9ef>all</span> <span style=color:#ae81ff>0.5</span><span style=color:#66d9ef>s</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>ul-enter</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>ul-leave-to</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>相关逻辑可自行观看，这里不在赘述了，并不复杂。</p><p>也顺带是复习一下 HTML 中鼠标事件和 vue 自定义命令了</p><h3 id=功能实现>功能实现
<a class=header-anchor href=#%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0></a></h3><p>主要功能</p><ul><li><p>检测视频页面，输出对应 up 主，关注数以及视频标题播放（参数过多就不一一显示了）</p></li><li><p>监控关键词根据内容判断是否点赞，例如文本出现了下次一定，那么就点赞。</p></li></ul><h4 id=输出相关信息>输出相关信息
<a class=header-anchor href=#%e8%be%93%e5%87%ba%e7%9b%b8%e5%85%b3%e4%bf%a1%e6%81%af></a></h4><p>这个其实只要接触过一丢丢爬虫的肯定都会知道如何实现，通过右键审查元素，像这样</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210918104907148.png alt=image-20210918104907148></p><p>然后使用 dom 操作，选择对应的元素，输出便可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#f92672>&gt;</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#v_upinfo &gt; div.up-info_right &gt; div.name &gt; a.username&#34;</span>).<span style=color:#a6e22e>innerText</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span> <span style=color:#e6db74>&#39;老番茄&#39;</span>
</span></span></code></pre></div><p>当然使用 JQuery 效果也是一样的。后续我都会使用 JQuery 来进行操作</p><p>在 src/content-script/bilibili.js 中写下如下代码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>window.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;加载完毕&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getInfo</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#v_upinfo &gt; div.up-info_right &gt; div.name &gt; a.username&#39;</span>).<span style=color:#a6e22e>text</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>follow</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>`#v_upinfo &gt; div.up-info_right &gt; div.btn-panel &gt; div.default-btn.follow-btn.btn-transition.b-gz.following &gt; span &gt; span &gt; span`</span>).<span style=color:#a6e22e>text</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>`#viewbox_report &gt; h1 &gt; span`</span>).<span style=color:#a6e22e>text</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>view</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#viewbox_report &gt; div &gt; span.view&#39;</span>).<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;title&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>username</span>, <span style=color:#a6e22e>follow</span>, <span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>view</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getInfo</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>重新加载插件，然后输出查看结果</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>加载完毕
</span></span><span style=display:flex><span>bilibili.js:19 老番茄 1606.0万 顶级画质 总播放数2368406
</span></span></code></pre></div><p>这些数据肯定单纯的输出肯定是没什么作用的，要能显示到内嵌悬浮窗口，或者是 popup 页面上（甚至发送 ajax 请求到远程服务器上保存）</p><p>对上面代码微改一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>window.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;加载完毕&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getInfo</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#v_upinfo &gt; div.up-info_right &gt; div.name &gt; a.username&#39;</span>).<span style=color:#a6e22e>text</span>().<span style=color:#a6e22e>trim</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>follow</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>`#v_upinfo &gt; div.up-info_right &gt; div.btn-panel &gt; div.default-btn.follow-btn.btn-transition.b-gz.following &gt; span &gt; span &gt; span`</span>).<span style=color:#a6e22e>text</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>`#viewbox_report &gt; h1 &gt; span`</span>).<span style=color:#a6e22e>text</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>view</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#viewbox_report &gt; div &gt; span.view&#39;</span>).<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;title&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//console.log(username, follow, title, view);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    window.<span style=color:#a6e22e>kz_vm</span>.<span style=color:#a6e22e>user</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>username</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>follow</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>view</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getInfo</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>其中<code>window.kz_vm</code>是通过<code>window.kz_vm = new Vue()</code> 初始化的，方便我们操作 vm 对象，就需要通过 jquery 选择元素在添加属性了。如果你想的话也可以直接在 content-script.js 上编写代码，这样就无需使用 window 对象，但这样导致一些业务逻辑都堆在一个文件里，所以我习惯分成 bilibili.js 然后注入方式为 document_end，然后在操作 dom 元素吗，实现效果如下</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20210918110958104.png alt=image-20210918110958104></p><p>如果像显示到 popup 页面只需要通过页面通信就行了，不过前提得先 popup 打开才行，所以一般都是通过 background 来进行中转，一般来说很少 content –> popup（因为操作 popup 的前提都是 popup 要打开），相对更多的是 content –> background 或 popup –> content</p><p><a href=https://www.cnblogs.com/liuxianan/p/chrome-plugin-develop.html#content-script%e4%b8%bb%e5%8a%a8%e5%8f%91%e6%b6%88%e6%81%af%e7%bb%99%e5%90%8e%e5%8f%b0 title="content-script 主动发消息给后台 我是小茗同学 - 博客园 (cnblogs.com)" rel="noopener external nofollow noreferrer" target=_blank class=exturl>content-script 主动发消息给后台 我是小茗同学 - 博客园 (cnblogs.com)
<i class="fa fa-external-link-alt"></i></a></p><h4 id=实现评论>实现评论
<a class=header-anchor href=#%e5%ae%9e%e7%8e%b0%e8%af%84%e8%ae%ba></a></h4><p>这边简单编写了一下页面，通过 popup 给 content，让 content 输入评论内容，与点击发送，先看效果</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/bilibili_comment.gif alt=bilibili_comment></p><p>同样的，找到对应元素位置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 评论文本框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; textarea&#39;</span>).<span style=color:#a6e22e>val</span>(<span style=color:#e6db74>&#39;要回复的内容&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// 评论按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; button&#39;</span>).<span style=color:#a6e22e>click</span>()
</span></span></code></pre></div><p>接着就是写页面通信的了，可以看到是 popup 向 content 发送请求</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>window.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;content加载完毕&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>comment</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>onMessage</span>.<span style=color:#a6e22e>addListener</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>sender</span>, <span style=color:#a6e22e>sendResponse</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> { <span style=color:#a6e22e>cmd</span>, <span style=color:#a6e22e>message</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>request</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>cmd</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;addComment&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; textarea&#39;</span>).<span style=color:#a6e22e>val</span>(<span style=color:#a6e22e>message</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; button&#39;</span>).<span style=color:#a6e22e>click</span>()
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sendResponse</span>(<span style=color:#e6db74>&#39;我收到了你的消息！&#39;</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>comment</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>el-container</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>el-header</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;24&#34;</span>&gt;B站小工具&lt;/<span style=color:#f92672>el-header</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>el-main</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>el-row</span> <span style=color:#a6e22e>:gutter</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;5&#34;</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>el-input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;textarea&#34;</span> <span style=color:#a6e22e>:rows</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;请输入内容&#34;</span> <span style=color:#a6e22e>v-model</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;message&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mb-5&#34;</span>&gt; &lt;/<span style=color:#f92672>el-input</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>el-button</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;addComment&#34;</span>&gt;评论&lt;/<span style=color:#f92672>el-button</span>&gt;
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>el-row</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>el-main</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>el-container</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;App&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span>() {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>list</span><span style=color:#f92672>:</span> [],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>open</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>created</span>() {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>storage</span>.<span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;list&#39;</span>, (<span style=color:#a6e22e>obj</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>obj</span>[<span style=color:#e6db74>&#39;list&#39;</span>]
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mounted</span>() {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>onMessage</span>.<span style=color:#a6e22e>addListener</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>sender</span>, <span style=color:#a6e22e>sendResponse</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;收到来自content-script的消息：&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>sender</span>, <span style=color:#a6e22e>sendResponse</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sendResponse</span>(<span style=color:#e6db74>&#39;我是后台，我已收到你的消息：&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>request</span>))
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>methods</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sendMessageToContentScript</span>(<span style=color:#a6e22e>message</span>, <span style=color:#a6e22e>callback</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>tabs</span>.<span style=color:#a6e22e>query</span>({ <span style=color:#a6e22e>active</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#a6e22e>currentWindow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> }, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>tabs</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>tabs</span>.<span style=color:#a6e22e>sendMessage</span>(<span style=color:#a6e22e>tabs</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>message</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) <span style=color:#a6e22e>callback</span>(<span style=color:#a6e22e>response</span>)
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>addComment</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>sendMessageToContentScript</span>({ <span style=color:#a6e22e>cmd</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;addComment&#39;</span>, <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>message</span> }, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;来自content的回复：&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>response</span>)
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>代码就不解读了，调用 sendMessageToContentScript 方法即可。相关源码可自行下载查看</p><p>实现类似点赞功能也是同理的。</p><h2 id=相关模板>相关模板
<a class=header-anchor href=#%e7%9b%b8%e5%85%b3%e6%a8%a1%e6%9d%bf></a></h2><p><a href=https://github.com/antfu/vitesse-webext title=vitesse-webext rel="noopener external nofollow noreferrer" target=_blank class=exturl>vitesse-webext
<i class="fa fa-external-link-alt"></i></a></p><p><a href=https://www.plasmo.com/ title=plasmo rel="noopener external nofollow noreferrer" target=_blank class=exturl>plasmo
<i class="fa fa-external-link-alt"></i></a></p><h2 id=整体体验>整体体验
<a class=header-anchor href=#%e6%95%b4%e4%bd%93%e4%bd%93%e9%aa%8c></a></h2><p>当时写 Chrome 插件的效率不能说慢，反正不快就是了，像一些 tips，都得自行封装。用过 Vue 的都知道写网页很方便，写 Chrome 插件未尝不是编写一个网页，当时的我在接触了 Vue 后就萌发了使用 vue 来编写 Chrome 的想法，当然肯定不止我一个这么想过，所以我在 github 上就能搜索到相应的源码，于是就有了这篇文章。</p><p>如果有涉及到爬取数据相关的，我肯定是首选使用 HTTP 协议，如果在搞不定我会选择使用 puppeteerjs，不过 Chrome 插件主要还是增强页面功能的，可以实现原本页面不具备的功能。</p><p>本文仅仅只是初步体验，简单编写了个小项目，后期有可能会实现一个百度网盘一键填写提取码，Js 自吐 Hooke 相关的。（原本是打算做 pdd 商家自动回复的，客户说要用客户端而不是网页端（客户端可以多号登陆），无奈，这篇博客就拿 B 站来演示了）</p></div><footer class=post-footer><div class=post-tags><a href=/tags/chrome>chrome</a>
<a href=/tags/plugin>plugin</a>
<a href=/tags/vue>vue</a>
<a href=/tags/develop>develop</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="爸比娃娃 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="爸比娃娃 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
使用Vue开发Chrome插件</li><li class=post-copyright-author><strong>本文作者：</strong>
爸比娃娃</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blog.jiandan.cf/post/program/vue-chrome-extension/ title=使用Vue开发Chrome插件>https://blog.jiandan.cf/post/program/vue-chrome-extension/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i></span>
<span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i></span>
<span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/develop/use-jsonpath-to-parse-json-data/ rel=next title=使用JSONPath解析json数据><i class="fa fa-chevron-left"></i> 使用JSONPath解析json数据</a></div><div class="post-nav-prev post-nav-item"><a href=/post/develop/try-to-cloud-develop/ rel=prev title=尝试云开发>尝试云开发
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>爸比娃娃</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.116.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel></a>
<a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云></a>
<a target=_blank href=https://webify.cloudbase.net title=Webify>Webify</a>
<span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://blog.jiandan.cf/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o \n\n可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄\n(Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.0fb3547374c917d23a2e5f762b70f3698d20b46a01cc18c38f9c467aeffc99fc.js defer></script></body></html>