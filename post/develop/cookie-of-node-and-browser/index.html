<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.116.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple-touch-icon.png><meta itemprop=name content="node与浏览器中的cookie"><meta itemprop=description content="有钱说什么都是硬道理，没钱说什么都是吹牛逼。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blog.jiandan.cf/imgs/babiwawa.png"><meta itemprop=keywords content="node,axios,cookie"><meta property="og:type" content="article"><meta property="og:title" content="node与浏览器中的cookie"><meta property="og:description" content="有钱说什么都是硬道理，没钱说什么都是吹牛逼。"><meta property="og:image" content="/imgs/babiwawa.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blog.jiandan.cf/post/develop/cookie-of-node-and-browser/"><meta property="og:site_name" content="爸比娃娃的博客"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="爸比娃娃"><meta property="article:published_time" content="2020-12-10 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2020-12-10 00:00:00 +0000 UTC"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.ad1ea33a63f63e6a94f5de191c205129577cfd392e2e10dec0f173ca5bdf0b7b.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"cookie-of-node-and-browser","permalink":"https://blog.jiandan.cf/post/develop/cookie-of-node-and-browser/","title":"node与浏览器中的cookie","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>node与浏览器中的cookie - 爸比娃娃的博客</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>爸比娃娃的博客</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>爸比娃娃的博客</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>125</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#封装>封装</a><ul><li><ul><li><a href=#requestjs>request.js</a></li><li><a href=#apiuserjs>api/user.js</a></li></ul></li></ul></li><li><a href=#踩坑-cookies-获取与设置>踩坑 Cookies 获取与设置</a><ul><li><a href=#浏览器>浏览器</a><ul><li><a href=#完整封装代码>完整封装代码</a></li></ul></li><li><a href=#nodejs>Nodejs</a></li></ul></li><li><a href=#总结>总结</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=爸比娃娃 src=/imgs/img-lazy-loading.gif data-src=/imgs/babiwawa.png><p class=site-author-name itemprop=name>爸比娃娃</p><div class=site-description itemprop=description>有钱说什么都是硬道理，没钱说什么都是吹牛逼。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>125</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>4</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>117</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/babiwawa title="Github → https://github.com/babiwawa" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span>
<span class=links-of-social-item><a href=mailto:1223112302@qq.com title="E-Mail → mailto:1223112302@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail</a></span>
<span class=links-of-social-item><a href=https://www.zhihu.com/people/hbalnw title="知乎 → https://www.zhihu.com/people/hbalnw" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://jiandan.cf title=https://jiandan.cf target=_blank>简单导航</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=0001-01-01T00:00:00+00:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=287557></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=640></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2023-01-04T00:00:00+00:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=直达底部><i class="fas fa-arrow-down"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/babiwawa rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script>
<script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blog.jiandan.cf/post/develop/cookie-of-node-and-browser/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/babiwawa.png"><meta itemprop=name content="爸比娃娃"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="爸比娃娃"><meta itemprop=description content="有钱说什么都是硬道理，没钱说什么都是吹牛逼。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="node与浏览器中的cookie"><meta itemprop=description content="前言 记录一下自己在 nodejs 中使用 http 请求库 axios 中的一些坑（针对 Cookie 操作） 不敢说和别人封装的 axios 相比有多好，但绝对是你能收获到 axios 的一些知识，话不多说，开始 封"></span><header class=post-header><h1 class=post-title itemprop="name headline">node与浏览器中的cookie</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text title=发表于>发表于：</span>
<time title="创建时间：2020-12-10 00:00:00 +0000 UTC" itemprop="dateCreated datePublished" datetime="2020-12-10 00:00:00 +0000 UTC">2020-12-10</time></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span>
<span>3015</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>7分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv data-path=/post/develop/cookie-of-node-and-browser/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><h2 id=前言>前言
<a class=header-anchor href=#%e5%89%8d%e8%a8%80></a></h2><p>记录一下自己在 nodejs 中使用 http 请求库 axios 中的一些坑（针对 Cookie 操作）</p><p>不敢说和别人封装的 axios 相比有多好，但绝对是你能收获到 axios 的一些知识，话不多说，开始</p><h2 id=封装>封装
<a class=header-anchor href=#%e5%b0%81%e8%a3%85></a></h2><p>一般而言，很少有裸装使用 axios 的，就我涉及的项目来说，我都会将 axios 的 request 封装成一个函数使用，接着在 api 目录下，引用该文件。项目结构一般是这样的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>|-- src
</span></span><span style=display:flex><span>	|-- api
</span></span><span style=display:flex><span>		|-- user.js
</span></span><span style=display:flex><span>		|-- goods.js
</span></span><span style=display:flex><span>	|-- utils
</span></span><span style=display:flex><span>		|-- request.js
</span></span></code></pre></div><h4 id=requestjs>request.js
<a class=header-anchor href=#requestjs></a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>axios</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>instance</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>create</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>baseURL</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>API</span>, <span style=color:#75715e>// node环境变量获取的Api地址
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>withCredentials</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 跨域携带Cookies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>timeout</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>,
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#75715e>// 设置请求拦截器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>instance</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>use</span>(
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>config</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 在config可以添加自定义协议头 例如token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;x-token&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;xxxxxxxx&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>error</span>) =&gt; {
</span></span><span style=display:flex><span>    Promise.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>instance</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>use</span>(
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>response</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据对应的业务代码 对返回数据进行处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>error</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>response</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>error</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 状态码为4或5开头则会报错
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 根据根据对应的错误,反馈给前端显示
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>404</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;请求资源路径不存在&#39;</span>)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>response</span>)
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 断网......
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>instance</span>
</span></span></code></pre></div><p>实际上，上面那样的封装就够了，相对于的业务代码就不补充了，如果你的宿主环境是浏览器的话，很多东西你就没必要在折腾的，甚至下面的文章都没必要看（不过还是推荐你看看，会有帮助的）。不过没完，再看看 api 里怎么使用的</p><h4 id=apiuserjs>api/user.js
<a class=header-anchor href=#apiuserjs></a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>request</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/utils/request&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>login</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>request</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/user/login&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;post&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span>,
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>info</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>request</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/user/info&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;get&#39;</span>,
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>logout</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>request</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/user/logout&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;post&#39;</span>,
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>看来很简单，没错，就是这么简单，由于是运行在浏览器内的，所以像 cookies，headers 等等都没必要设置，浏览器会自行携带该有的设置，其实想设置也设置不了，主要就是浏览器内置跨域问题。
<a href=https://fetch.spec.whatwg.org/#concept-header-name title=XMLHttpRequest rel="noopener external nofollow noreferrer" target=_blank class=exturl>XMLHttpRequest
<i class="fa fa-external-link-alt"></i></a></p><p>就这？感觉你写的跟别人没什么区别啊</p><p>别急，下面才是重头戏。也是我为啥标题只写 axios，而不写 vue-axios 或者 axios 封装的原因。</p><h2 id=踩坑-cookies-获取与设置>踩坑 Cookies 获取与设置
<a class=header-anchor href=#%e8%b8%a9%e5%9d%91-cookies-%e8%8e%b7%e5%8f%96%e4%b8%8e%e8%ae%be%e7%bd%ae></a></h2><h3 id=浏览器>浏览器
<a class=header-anchor href=#%e6%b5%8f%e8%a7%88%e5%99%a8></a></h3><p>运行环境在浏览器中，axios 是无法设置与获取 cookie，获取不到 set-cookies 这个协议头的（即使服务器设置了也没用），先看代码与输出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>instance</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>use</span>((<span style=color:#a6e22e>config</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;cookie&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;cookie=this_is_cookies;username=kuizuo;&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;config.headers&#39;</span>, <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>instance</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>use</span>((<span style=color:#a6e22e>response</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;response.headers&#39;</span>, <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>headers</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>控制台结果：</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20201210060704240.png alt=image-20201210060704240></p><p>首先，就是圈的这个，浏览器是不许允许设置一些不安全的协议头，例如 Cookie，Orgin，Referer 等等，即便你看到控制台 config.headers 确实有刚刚设置 cookie，但我们输出的也只是 headers 对象，在 Network 中找到这个请求，也同样看不到 Cookie 设置的（这就不放图了）。</p><p>同样的，通过响应拦截器中输出的 headers 中也没有 set-cookies 这个字样。网络上很多都是说，添加这么一行代码 <code>withCredentials: true</code>，确实，但是没说到重点，都没讲述到怎么获取 cookies 的，因为在<strong>浏览器环境中 axios 压根就获取不到 set-cookies 这个协议头</strong>，实际上 axios 就没必要，因为浏览器会自行帮你获取服务器返回的 Cookies，并将其写入在 Storage 里的 Cookies 中，再下次请求的时候根据同源策略携带上对应的 Cookie。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20201210061627824.png alt=image-20201210061627824></p><p>要获取也很简单，vue 中通过<code>js-cookie</code>模块即可，而在 electron 中通过<code>const { session } = require('electron').remote</code> （electron 可以设置允许跨域，好用）有关更多可以自行查看文档。</p><p>那我就是想要设置 Cookies，来跳过登录等等咋办，我的建议是别用浏览器来伪装 http 请求。跨域是浏览器内不可少的一部分，并且要允许跨域过于麻烦。有关跨域，我推一篇文章
<a href=https://juejin.cn/post/6844904126246027278 title="10 种跨域解决方案（附终极大招）" rel="noopener external nofollow noreferrer" target=_blank class=exturl>10 种跨域解决方案（附终极大招）
<i class="fa fa-external-link-alt"></i></a></p><h4 id=完整封装代码>完整封装代码
<a class=header-anchor href=#%e5%ae%8c%e6%95%b4%e5%b0%81%e8%a3%85%e4%bb%a3%e7%a0%81></a></h4><p>::: details 查看代码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>axios</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>MessageBox</span>, <span style=color:#a6e22e>Message</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;element-ui&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>store</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/store&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>getToken</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/utils/auth&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>service</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>create</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>baseURL</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>VUE_APP_BASE_API</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>withCredentials</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timeout</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>,
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>use</span>(
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>config</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>store</span>.<span style=color:#a6e22e>getters</span>.<span style=color:#a6e22e>token</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;x-token&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>getToken</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>error</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>use</span>(
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>response</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>200</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Error&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#66d9ef>new</span> Error(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;未知错误&#39;</span>))
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>error</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>400</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;非法请求&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>401</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>MessageBox</span>.<span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#39;当前登录已过期，请重新登录&#39;</span>, <span style=color:#e6db74>&#39;提示&#39;</span>, {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>confirmButtonText</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新登录&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;warning&#39;</span>,
</span></span><span style=display:flex><span>          }).<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>store</span>.<span style=color:#a6e22e>dispatch</span>(<span style=color:#e6db74>&#39;user/logout&#39;</span>).<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>reload</span>()
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>403</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;非法请求&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>push</span>(<span style=color:#e6db74>&#39;/401&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>404</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;请求资源不存在&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>500</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;服务器开小差啦&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>statusText</span>)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>msg</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;请检查网络连接状态&#39;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>service</span>
</span></span></code></pre></div><p>:::</p><h3 id=nodejs>Nodejs
<a class=header-anchor href=#nodejs></a></h3><p>作为 nodejs 的主流 http 框架怎么能只用在浏览器上，nodejs 自然而然可以，不过 nodejs 需要配置的可就多了，在 nodejs 环境中，自然没有浏览器的同源策略，像上面设置不了的 Cookie，现在随便设置，先看看我是怎么封装的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>axios</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>http</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;http&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>https</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;https&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>request</span>(<span style=color:#a6e22e>opt</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> { <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>method</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;get&#39;</span>, <span style=color:#a6e22e>headers</span> <span style=color:#f92672>=</span> {}, <span style=color:#a6e22e>cookies</span>, <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>opt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;User-Agent&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;Referer&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>url</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>cookies</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;object&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;Cookie&#39;</span>] <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>keys</span>(<span style=color:#a6e22e>cookies</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>k</span>) =&gt; encodeURIComponent(<span style=color:#a6e22e>k</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;=&#39;</span> <span style=color:#f92672>+</span> encodeURIComponent(<span style=color:#a6e22e>cookies</span>[<span style=color:#a6e22e>k</span>]))
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;; &#39;</span>)
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>cookies</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;string&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;Cookie&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>cookies</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>options</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>method</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>headers</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>queryString</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>data</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>httpAgent</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Agent</span>({ <span style=color:#a6e22e>keepAlive</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> }),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>httpsAgent</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>https</span>.<span style=color:#a6e22e>Agent</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>keepAlive</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rejectUnauthorized</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>timeout</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>,
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>request</span>(<span style=color:#a6e22e>options</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>e</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>message</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// test.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>request</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./request&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>test</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://passport2.chaoxing.com/fanyalogin&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fid</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;-1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>uname</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;15212345678&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a12345678&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>refer</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;http%253A%252F%252Fi.mooc.chaoxing.com&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>t</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;true&#39;</span>,
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>headers</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cookies</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;username=kuizuo;uid=123;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>request</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>headers</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cookies</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;test -&gt; res.headers&#39;</span>, <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>headers</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>data</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>test</span>();
</span></span></code></pre></div><p>测试一下，顺便抓一下包，看看请求包</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>GET</span> /fanyalogin <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>:</span> <span style=color:#ae81ff>application/json, text/plain, */*</span>
</span></span><span style=display:flex><span>User-Agent<span style=color:#f92672>:</span> <span style=color:#ae81ff>Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36</span>
</span></span><span style=display:flex><span>Referer<span style=color:#f92672>:</span> <span style=color:#ae81ff>https://passport2.chaoxing.com/fanyalogin</span>
</span></span><span style=display:flex><span>Cookie<span style=color:#f92672>:</span> <span style=color:#ae81ff>username=kuizuo;uid=123;</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>passport2.chaoxing.com</span>
</span></span><span style=display:flex><span>Connection<span style=color:#f92672>:</span> <span style=color:#ae81ff>keep-alive</span>
</span></span><span style=display:flex><span>Content-Length<span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>....
</span></span></code></pre></div><p>有我们自定义的 Cookie，在看看响应的协议头</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>test</span> <span style=color:#f92672>-&gt;</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>headers</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>server</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Tengine&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Thu, 10 Dec 2020 00:24:15 GMT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;content-type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;text/html&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;content-length&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1852&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>connection</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;keep-alive&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Accept-Encoding&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;set-cookie&#39;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;JSESSIONID=4365A6B9FD8E0CBADDBDD7E7DA468F7E; Path=/; HttpOnly&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;route=b2eda164bddd148142a54809ef404926;Path=/&#39;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;accept-ranges&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;bytes&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>etag</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;W/&#34;1852-1606444212000&#34;&#39;</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>同样能获取到 set-cookie，设置与获取都是这么 so easy ，不同于上面浏览器的配置。</p><p>这里我要说明一些东西，在封装代码中有个 httpAgent 与 httpsAgent，你可以字面翻译就是 http 代理，设置它用来干嘛呢，其中有这么个属性 <code>keepAlive: true</code> ，如果设置了协议头中的将会有 <code>Connection: keep-alive</code>，而不设置则 <code>Connection: close</code>，这里也不想过多说明 http 相关知识，如果只是请求一次,那么两者没有太大区别</p><p>然而如果我请求一次,过一会(几秒内)又要请求了,那么 keep-alive 一次连接就可以处理多个请求，而 close 则是一次请求后就断开，下次就需要再次连接。说白了就是快一点，而 close 需要不断连接，断开，自然而然就慢。一般来说设置 keep-alive 就对了。</p><p>其中在 httpsAgent 中，还有一个属性<code>rejectUnauthorized: false</code>，说简单点，就是不抛出验证错误，在抓 nodejs 包的时候，如果不通过设置代理服务器（Fiddler，Charles），而是通过网卡（HTTP Analyzer，Wireshark）就会抛出异常，一般就会出现这种错误。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>Error: unable to verify the first certificate
</span></span></code></pre></div><p>然而问题就来了，服务端的返回的 set-cookie 该怎么保存。如果只是涉及客户端层面的，想写一个模拟 http 请求的，直接将获取到的 cookies 与原有的 cookie 合并即可。我那时候的代码就是这样：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newCookie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>header</span>[<span style=color:#e6db74>&#39;set-cookie&#39;</span>]
</span></span><span style=display:flex><span>  <span style=color:#f92672>?</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>header</span>[<span style=color:#e6db74>&#39;set-cookie&#39;</span>]
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>a</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;;&#39;</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;; &#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// mergeCookie 就是将两者cookie 拼接而成
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newCookies</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mergeCookie</span>(<span style=color:#a6e22e>cookies</span>, <span style=color:#a6e22e>newCookie</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>res</span>[<span style=color:#a6e22e>cookie</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>newCookies</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>
</span></span></code></pre></div><p>然后返回响应中携带 res.cookies 即可，下次请求的时候再将其在带上。</p><p>如果只是，利用 nodejs 来实现类似爬虫，模拟登录，然后利用登录后的 cookie，来获取用户信息。如果不希望手动处理 cookies 的话，我其实还是推荐一个 http 模块，superagent，做一些小爬虫和模拟请求挺好用的，就不做过多介绍了。不过由于 nestjs 中自带 axios 模块，加上需要转发 http 请求，于是我就自行封装了一个 axios。</p><h2 id=总结>总结
<a class=header-anchor href=#%e6%80%bb%e7%bb%93></a></h2><p>实际上，axios 会根据当前环境，来创建 xhr 对象（浏览器）还是 http 对象（nodejs），在我那时候都以为 axios 是两个共用的，初学 electron 的时候，一直卡在 http 请求的配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>  <span style=color:#f92672>//</span> <span style=color:#f92672>`</span>adapter<span style=color:#f92672>`</span> allows custom handling of requests which makes testing easier.
</span></span><span style=display:flex><span>  <span style=color:#f92672>//</span> <span style=color:#66d9ef>Return</span> a promise <span style=color:#66d9ef>and</span> supply a valid <span style=color:#a6e22e>response</span> (see lib<span style=color:#f92672>/</span>adapters<span style=color:#f92672>/</span>README.md).
</span></span><span style=display:flex><span>  adapter: <span style=color:#a6e22e>function</span> (config) <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ... */</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>,
</span></span></code></pre></div><p>在 axios 中也有这么一段配置，翻看了 lib/adapters 下目录我才瞬间醒悟过来，两者环境是不同的。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.kuizuo.cn/image-20201210214055696.png alt=image-20201210214055696></p><p>就我使用而言，在浏览器环境下 axios 处理的特别好，允许设置拦截器处理请求与响应，但在 nodejs 下在处理模拟请求确实不如 Python 的 request 模块，奈何 axios 最大的便携就是能直接在浏览器中，尤大推荐的 http 请求库也是 axios。</p><p>实际上还涉及到了 nodejs 中转发请求的，再给自己留一个坑。</p><p>在写这篇文章的时候，我其实都没读过 axios 的源码，说实话，那时候遇到问题，就不应该愚昧的去搜索，去不断尝试，有时候直接通过翻看底层代码，可以一目了然自己所面临问题的解决方式。</p></div><footer class=post-footer><div class=post-tags><a href=/tags/node>node</a>
<a href=/tags/axios>axios</a>
<a href=/tags/cookie>cookie</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="爸比娃娃 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="爸比娃娃 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
node与浏览器中的cookie</li><li class=post-copyright-author><strong>本文作者：</strong>
爸比娃娃</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blog.jiandan.cf/post/develop/cookie-of-node-and-browser/ title=node与浏览器中的cookie>https://blog.jiandan.cf/post/develop/cookie-of-node-and-browser/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i></span>
<span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i></span>
<span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/develop/content-type-of-http-request/ rel=next title=HTTP请求之Content-Type><i class="fa fa-chevron-left"></i> HTTP请求之Content-Type</a></div><div class="post-nav-prev post-nav-item"><a href=/post/develop/server-and-domain-beian/ rel=prev title=服务器与域名备案>服务器与域名备案
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>爸比娃娃</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.116.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel></a>
<a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云></a>
<a target=_blank href=https://webify.cloudbase.net title=Webify>Webify</a>
<span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://blog.jiandan.cf/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o \n\n可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄\n(Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.0fb3547374c917d23a2e5f762b70f3698d20b46a01cc18c38f9c467aeffc99fc.js defer></script></body></html>